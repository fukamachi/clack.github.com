<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>6. Clack.App.Directoryを使う | Tutorial | Clack - Web application environment for Common Lisp</title>
    <link href="../../main.css" rel="stylesheet" type="text/css" />
    <link href="./ja.css" rel="stylesheet" type="text/css" />
  </head>
  <body>

<h1><a href="/">Clack</a></h1>
<p class="tagline">Revenge of Lisp in Web</p>

<h2>Chapter 6: Clack.App.Directoryを使う</h2>

<p class="language">
  <a href="../06-using-clack-app-directory.html">English</a> | <strong>日本語</strong>
</p>

<div id="main">

<p>Clack.App.Directoryは<code>&lt;component&gt;</code>を使ったClackアプリケーションの実例です。このアプリケーションはディレクトリをHTMLページとして返します。</p>

<p>以下のように使います。</p>

<pre>
;; /Users/nitro_idiot/ を http://localhost:5000/ に
(clack:clackup
 (make-instance 'clack.app.directory:&lt;clack-app-directory&gt;
    :root #p"/Users/nitro_idiot/")
 :port 5000)
</pre>

<p>すると"/Users/nitro_idiot/"の中のファイルが http://localhost:5000/ で見られるようになります。</p>

<img src="../clack-app-directory.png" width="80%"/>

<p>なぜこのアプリケーションは、ただの関数ではなく<code>&lt;component&gt;</code>を使っているかわかるでしょうか？ インスタンスを作るときに<code>:root</code>を引数に取り、その値によって挙動が変わります。これは、アプリケーションが関数として実装されていると難しいです。</p>

<p>クロージャを返す関数でも同じことができることは複雑になります。また、クラスを使う利点がもう一つあります。──<strong>継承</strong>です。正直に言うと、<code>&lt;clack-app-directory&gt;</code>は<code>&lt;component&gt;</code>を直接継承していません。<code>&lt;clack-app-file&gt;</code>を継承しています。これはディレクトリではなくファイルだけを配信するアプリケーションです。<code>&lt;clack-app-directory&gt;</code>がするのは、ただディレクトリ内のファイルを一覧できるようにするだけです。</p>

<p>興味がある人はcore/app/directory.lispとfile.lispを見るとコンポーネントがどのように使われているかがわかると思います。</p>

</div>

<div id="footer">
  <div class="left"><a href="05-component.html">&lt;&lt;5. コンポーネント</a></div>
  <div class="center"><a href="./">Tutorial</a></div>
  <div class="right"><!--<a href="07-middleware.html">7. ミドルウェア &gt;&gt;</a>--></div>
</div>

  </body>
</html>
